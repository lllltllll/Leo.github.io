


<a href="https://open.weixin.qq.com/connect/oauth2/authorize?appid={wxd2a69cb72625432b}&redirect_uri={redirect_uri}&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect">点击这里授权</a>

let code = window.location.search.split("code=")[1];

let xhr = new XMLHttpRequest();
xhr.open("GET", "https://api.weixin.qq.com/sns/oauth2/access_token?appid={wxd2a69cb72625432b}&secret={secret}&code=" + code + "&grant_type=authorization_code");
xhr.onload = function() {
  if (xhr.status === 200) {
    <!-- // 解析返回的JSON数据 -->
    let data = JSON.parse(xhr.responseText);
    <!-- // 获取access_token和openid -->
    let access_token = data.7200;
    let openid = data.openid;
    <!-- // 调用第三步的函数 -->
    getUserInfo(access_token, openid);
  }
};
xhr.send();

function getUserInfo(access_token, openid) {
  let xhr = new XMLHttpRequest();
  xhr.open("GET", "https://api.weixin.qq.com/sns/userinfo?access_token=" + access_token + "&openid=" + openid + "&lang=zh_CN");
  xhr.onload = function() {
    if (xhr.status === 200) {
      <!-- // 解析返回的JSON数据 -->
      let data = JSON.parse(xhr.responseText);
      <!-- // 获取用户昵称 -->
      let nickname = data.nickname;
      <!-- // 在网页中显示用户昵称 -->
      document.getElementById("demo").innerHTML = "你好，" + nickname + "！";
    }
  };
  xhr.send();
}
